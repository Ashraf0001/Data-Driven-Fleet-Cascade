# Fleet Decision Platform - Main Configuration
# This is the primary configuration file for the platform

# =============================================================================
# Data Configuration
# =============================================================================
data:
  # NYC Taxi data settings
  nyc_taxi:
    path: "data/raw/nyc_taxi"
    # Taxi zones to use (NYC TLC zone IDs)
    zones: [4, 12, 13, 68, 79]  # Manhattan zones
    # Time range for data (YYYY-MM-DD format)
    time_range: "2023-01-01:2023-03-31"
    # Aggregation level
    aggregation: "hourly"  # or "daily"

  # NASA Turbofan data settings (for risk modeling)
  nasa_turbofan:
    path: "data/raw/nasa_turbofan"
    dataset: "FD001"  # FD001, FD002, FD003, or FD004

  # Fleet simulation settings
  fleet:
    num_vehicles: 50
    locations: 5
    capacity_per_vehicle: 1
    simulation_seed: 42
    # Vehicle status distribution
    status_distribution:
      operational: 0.85
      maintenance: 0.10
      downtime: 0.05

# =============================================================================
# Forecasting Configuration
# =============================================================================
forecasting:
  # Model selection: "xgboost", "prophet", "tft"
  model: "xgboost"

  # Forecast horizon
  horizon_days: 7
  horizon_hours: 168  # 7 * 24

  # Features to use
  features:
    - hour
    - day_of_week
    - month
    - is_weekend
    - demand_lag_1
    - demand_lag_24
    - demand_rolling_mean_24

  # XGBoost hyperparameters
  xgboost:
    n_estimators: 100
    max_depth: 6
    learning_rate: 0.1
    min_child_weight: 1
    subsample: 0.8
    colsample_bytree: 0.8
    random_state: 42

  # Training settings
  training:
    train_split: 0.8
    validation_split: 0.1
    test_split: 0.1

# =============================================================================
# Optimization Configuration
# =============================================================================
optimization:
  # Solver selection: "ortools", "pulp"
  solver: "ortools"

  # Optimization stages (for cascading optimization)
  stages:
    - min_cost_flow  # MVP: single stage
    # - critical_demand  # Phase 2+
    # - milp_refinement  # Phase 4

  # Constraints
  constraints:
    max_distance: 100  # Maximum rebalancing distance (km or units)
    capacity_per_vehicle: 1
    min_service_level: 0.95  # 95% demand coverage
    max_cost_per_vehicle: 50.0

  # Solver settings
  solver_settings:
    time_limit_seconds: 60
    optimality_gap: 0.01  # 1% optimality gap

# =============================================================================
# Risk Scoring Configuration
# =============================================================================
risk:
  # Risk model: "heuristic", "classification", "survival"
  model: "heuristic"  # MVP: simple heuristics

  # Heuristic scoring weights
  heuristic_weights:
    age: 0.3
    mileage: 0.4
    maintenance: 0.3

  # Risk thresholds
  thresholds:
    high: 0.7
    medium: 0.4
    low: 0.0

# =============================================================================
# API Configuration
# =============================================================================
api:
  host: "0.0.0.0"
  port: 8000
  debug: true
  reload: true

  # CORS settings
  cors:
    allow_origins: ["*"]
    allow_methods: ["*"]
    allow_headers: ["*"]

  # Rate limiting (Phase 2+)
  rate_limit:
    enabled: false
    requests_per_minute: 60

# =============================================================================
# Logging Configuration
# =============================================================================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "text"  # "text" for development, "json" for production

  # Log file settings
  file:
    enabled: false
    path: "logs/fleet_cascade.log"
    max_size_mb: 10
    backup_count: 5

# =============================================================================
# Database Configuration (Phase 2+)
# =============================================================================
database:
  # Use SQLite for MVP, PostgreSQL for production
  type: "sqlite"  # "sqlite" or "postgresql"

  sqlite:
    path: "data/fleet_cascade.db"

  postgresql:
    host: "${POSTGRES_HOST}"
    port: "${POSTGRES_PORT}"
    database: "${POSTGRES_DB}"
    user: "${POSTGRES_USER}"
    password: "${POSTGRES_PASSWORD}"

# =============================================================================
# Feature Flags
# =============================================================================
features:
  enable_caching: true
  enable_risk_scoring: true
  enable_explainability: false  # Enable in Phase 2+
  enable_contract_intelligence: false  # Enable in Phase 3+
